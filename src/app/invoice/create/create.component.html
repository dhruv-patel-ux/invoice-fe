<p-card header="Create Invoice">
    <form [formGroup]="invoiceForm" (ngSubmit)="onSubmit()">
      <div class="grid">
        <!-- From Details -->
        <div class="col-12 md:col-6" formGroupName="fromDetails">
          <h3>From</h3>
          <div class="field">
            <label for="fromName">Name</label>
            <input pInputText id="fromName" formControlName="name" class="w-full"/>
          </div>
          <div class="field">
            <label for="fromAddress">Address</label>
            <textarea pInputTextarea id="fromAddress" formControlName="address" rows="3" class="w-full"></textarea>
          </div>
        </div>

        <!-- To Details -->
        <div class="col-12 md:col-6" formGroupName="toDetails">
          <h3>To</h3>
          <div class="field">
            <label for="toName">Name</label>
            <input pInputText id="toName" formControlName="name" class="w-full"/>
          </div>
          <div class="field">
            <label for="toAddress">Address</label>
            <textarea pInputTextarea id="toAddress" formControlName="address" rows="3" class="w-full"></textarea>
          </div>
        </div>

        <!-- Items -->
        <div class="col-12">
          <h3>Items</h3>
          <div formArrayName="items" class="field">
            <div *ngFor="let item of items.controls; let i=index" [formGroupName]="i" class="grid mb-2">
              <div class="col-12 md:col-4">
                <input pInputText placeholder="Item Name" formControlName="itemName" class="w-full"/>
              </div>
              <div class="col-6 md:col-2">
                <p-inputNumber formControlName="quantity" placeholder="Quantity" [showButtons]="true" [min]="1" class="w-full"></p-inputNumber>
              </div>
              <div class="col-6 md:col-2">
                <p-inputNumber formControlName="rate" placeholder="Rate" mode="currency" currency="USD" class="w-full"></p-inputNumber>
              </div>
              <div class="col-6 md:col-2">
                <span class="text-lg">{{calculateItemTotal(item) | currency}}</span>
              </div>
              <div class="col-6 md:col-2">
                <button pButton icon="pi pi-trash" class="p-button-danger p-button-outlined" (click)="removeItem(i)"></button>
              </div>
            </div>
          </div>
          <button pButton label="Add Item" icon="pi pi-plus" (click)="addItem()" type="button" class="p-button-outlined"></button>
        </div>
      </div>

      <div class="flex justify-content-between mt-4">
        <span class="text-2xl font-bold">Total: {{calculateTotal() | currency}}</span>
        <button pButton label="Create Invoice" icon="pi pi-check" type="submit" [disabled]="!invoiceForm.valid"></button>
      </div>
    </form>
  </p-card>